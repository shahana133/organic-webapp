{% extends 'base.html' %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gray-100 p-4">
    <div class="bg-white shadow-lg rounded-2xl p-8 max-w-md w-full text-center border border-red-200">
        <!-- Warning Icon with Shake Effect -->
        <div class="flex justify-center mb-4">
            <svg class="w-10 h-10 text-red-500 shake" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L4.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
        </div>

        <h2 class="text-2xl font-bold text-red-600 mb-2">Action Not Allowed</h2>
        <p class="text-gray-700 text-lg mb-2">
            You cannot buy your own product: <strong>{{ product_name }}</strong>
        </p>
        <p class="text-gray-500 mb-4">
            Redirecting back to checkout in <span id="countdown">5</span> seconds...
        </p>

        <!-- Progress Bar -->
        <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
            <div id="progressBar" class="h-2.5 rounded-full transition-all duration-1000 ease-linear" style="width: 100%; background-color: #ef4444;"></div>
        </div>

        <a href="/checkout/" 
           class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow-md transition">
            Go Back Now
        </a>
    </div>
</div>

<!-- Countdown & Color-Changing Progress Script -->
<script>
    let seconds = 5;
    const countdownEl = document.getElementById("countdown");
    const progressBar = document.getElementById("progressBar");

    const colors = ["#ef4444", "#f97316", "#facc15", "#84cc16", "#22c55e"]; 
    // Red → Orange → Yellow → Lime → Green

    const timer = setInterval(() => {
        seconds--;
        countdownEl.textContent = seconds;
        progressBar.style.width = (seconds * 20) + "%";
        progressBar.style.backgroundColor = colors[5 - seconds] || "#22c55e";

        if (seconds <= 0) {
            clearInterval(timer);
            window.location.href = "/checkout/";
        }
    }, 1000);
</script>

<!-- Shake Effect -->
<style>
    .shake {
        animation: shake 0.5s ease-in-out 2;
    }
    @keyframes shake {
        0% { transform: translateX(0); }
        25% { transform: translateX(-4px); }
        50% { transform: translateX(4px); }
        75% { transform: translateX(-4px); }
        100% { transform: translateX(0); }
    }
</style>
{% endblock %}
